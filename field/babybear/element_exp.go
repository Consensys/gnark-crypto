// Copyright 2020-2026 Consensys Software Inc.
// Licensed under the Apache License, Version 2.0. See the LICENSE file for details.

// Code generated by consensys/gnark-crypto DO NOT EDIT

package babybear

// ExpBySqrtExp is equivalent to z.Exp(x, 7).
// It raises x to the (p-2^s-1)/2^(s+1) power using a shorter addition chain,
// where s the 2-adic valuation of p-1.
//
// uses github.com/mmcloughlin/addchain v0.4.0 to generate a shorter addition chain
func (z *Element) ExpBySqrtExp(x Element) *Element {
	// addition chain:
	//
	//	_10    = 2*1
	//	_11    = 1 + _10
	//	_110   = 2*_11
	//	return   1 + _110
	//
	// Operations: 2 squares 2 multiplies

	// Allocate Temporaries.
	var ()

	// var
	// Step 1: z = x^0x2
	z.Square(&x)

	// Step 2: z = x^0x3
	z.Mul(&x, z)

	// Step 3: z = x^0x6
	z.Square(z)

	// Step 4: z = x^0x7
	z.Mul(&x, z)

	return z
}

// ExpByCbrt2QPlus1Div9 is equivalent to z.Exp(x, 1aaaaaab).
// It raises x to the (2q+1)/9 power using a shorter addition chain.
// This is used when q â‰¡ 4 (mod 9) for efficient cube root computation.
//
// uses github.com/mmcloughlin/addchain v0.4.0 to generate a shorter addition chain
func (z *Element) ExpByCbrt2QPlus1Div9(x Element) *Element {
	// addition chain:
	//
	//	_10      = 2*1
	//	_11      = 1 + _10
	//	_110     = 2*_11
	//	_1001    = _11 + _110
	//	_10010   = 2*_1001
	//	_10101   = _11 + _10010
	//	_1010100 = _10101 << 2
	//	i15      = _1010100 << 6 + _1010100
	//	i17      = 2*i15 + _11
	//	return     (2*i17 + i15) << 14 + i17
	//
	// Operations: 27 squares 7 multiplies

	// Allocate Temporaries.
	var (
		t0 = new(Element)
		t1 = new(Element)
	)

	// var t0,t1 Element
	// Step 1: z = x^0x2
	z.Square(&x)

	// Step 2: z = x^0x3
	z.Mul(&x, z)

	// Step 3: t0 = x^0x6
	t0.Square(z)

	// Step 4: t0 = x^0x9
	t0.Mul(z, t0)

	// Step 5: t0 = x^0x12
	t0.Square(t0)

	// Step 6: t0 = x^0x15
	t0.Mul(z, t0)

	// Step 8: t0 = x^0x54
	for s := 0; s < 2; s++ {
		t0.Square(t0)
	}

	// Step 14: t1 = x^0x1500
	t1.Square(t0)
	for s := 1; s < 6; s++ {
		t1.Square(t1)
	}

	// Step 15: t0 = x^0x1554
	t0.Mul(t0, t1)

	// Step 16: t1 = x^0x2aa8
	t1.Square(t0)

	// Step 17: z = x^0x2aab
	z.Mul(z, t1)

	// Step 18: t1 = x^0x5556
	t1.Square(z)

	// Step 19: t0 = x^0x6aaa
	t0.Mul(t0, t1)

	// Step 33: t0 = x^0x1aaa8000
	for s := 0; s < 14; s++ {
		t0.Square(t0)
	}

	// Step 34: z = x^0x1aaaaaab
	z.Mul(z, t0)

	return z
}
