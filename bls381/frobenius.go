// Copyright 2020 ConsenSys AG
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

// Code generated by gurvy/internal/generators DO NOT EDIT

package bls381

import "github.com/consensys/gurvy/bls381/fp"

// Frobenius set z to Frobenius(x) in PairingResult and return z
func (z *PairingResult) Frobenius(x *PairingResult) *PairingResult {
	// Algorithm 28 from https://eprint.iacr.org/2010/354.pdf (beware typos!)
	var t [6]E2

	// Frobenius acts on fp2 by conjugation
	t[0].Conjugate(&x.C0.B0)
	t[1].Conjugate(&x.C0.B1)
	t[2].Conjugate(&x.C0.B2)
	t[3].Conjugate(&x.C1.B0)
	t[4].Conjugate(&x.C1.B1)
	t[5].Conjugate(&x.C1.B2)

	t[1].MulByNonResiduePower2(&t[1])
	t[2].MulByNonResiduePower4(&t[2])
	t[3].MulByNonResiduePower1(&t[3])
	t[4].MulByNonResiduePower3(&t[4])
	t[5].MulByNonResiduePower5(&t[5])

	z.C0.B0 = t[0]
	z.C0.B1 = t[1]
	z.C0.B2 = t[2]
	z.C1.B0 = t[3]
	z.C1.B1 = t[4]
	z.C1.B2 = t[5]

	return z
}

// FrobeniusSquare set z to Frobenius^2(x) in PairingResult and return z
func (z *PairingResult) FrobeniusSquare(x *PairingResult) *PairingResult {
	// Algorithm 29 from https://eprint.iacr.org/2010/354.pdf (beware typos!)
	var t [6]E2

	t[1].MulByNonResiduePowerSquare2(&x.C0.B1)
	t[2].MulByNonResiduePowerSquare4(&x.C0.B2)
	t[3].MulByNonResiduePowerSquare1(&x.C1.B0)
	t[4].MulByNonResiduePowerSquare3(&x.C1.B1)
	t[5].MulByNonResiduePowerSquare5(&x.C1.B2)

	z.C0.B0 = x.C0.B0
	z.C0.B1 = t[1]
	z.C0.B2 = t[2]
	z.C1.B0 = t[3]
	z.C1.B1 = t[4]
	z.C1.B2 = t[5]

	return z
}

// FrobeniusCube set z to Frobenius^3(x) in PairingResult and return z
func (z *PairingResult) FrobeniusCube(x *PairingResult) *PairingResult {
	// Algorithm 30 from https://eprint.iacr.org/2010/354.pdf (beware typos!)
	var t [6]E2

	// Frobenius^3 acts on fp2 by conjugation
	t[0].Conjugate(&x.C0.B0)
	t[1].Conjugate(&x.C0.B1)
	t[2].Conjugate(&x.C0.B2)
	t[3].Conjugate(&x.C1.B0)
	t[4].Conjugate(&x.C1.B1)
	t[5].Conjugate(&x.C1.B2)

	t[1].MulByNonResiduePowerCube2(&t[1])
	t[2].MulByNonResiduePowerCube4(&t[2])
	t[3].MulByNonResiduePowerCube1(&t[3])
	t[4].MulByNonResiduePowerCube3(&t[4])
	t[5].MulByNonResiduePowerCube5(&t[5])

	z.C0.B0 = t[0]
	z.C0.B1 = t[1]
	z.C0.B2 = t[2]
	z.C1.B0 = t[3]
	z.C1.B1 = t[4]
	z.C1.B2 = t[5]

	return z
}

// MulByNonResiduePower1 set z=x*(1,1)^(1*(p-1)/6) and return z
func (z *E2) MulByNonResiduePower1(x *E2) *E2 {
	// (1,1)^(1*(p-1)/6)
	// 3850754370037169011952147076051364057158807420970682438676050522613628423219637725072182697113062777891589506424760 + u*151655185184498381465642749684540099398075398968325446656007613510403227271200139370504932015952886146304766135027
	b := E2{
		A0: fp.Element{
			506819140503852133,
			14297063575771579155,
			10946065744702939791,
			11771194236670323182,
			2081670087578406477,
			644615147456521963,
		},
		A1: fp.Element{
			12895611875574011462,
			6359822009455181036,
			14936352902570693524,
			13914887797453940944,
			3330433690892295817,
			1229183470191017903,
		},
	}
	z.Mul(x, &b)
	return z
}

// MulByNonResiduePower2 set z=x*(1,1)^(2*(p-1)/6) and return z
func (z *E2) MulByNonResiduePower2(x *E2) *E2 {
	// (1,1)^(2*(p-1)/6)
	// 0 + u*4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436
	b := E2{
		A0: fp.Element{
			0,
			0,
			0,
			0,
			0,
			0,
		},
		A1: fp.Element{
			14772873186050699377,
			6749526151121446354,
			6372666795664677781,
			10283423008382700446,
			286397964926079186,
			1796971870900422465,
		},
	}
	z.Mul(x, &b)
	return z
}

// MulByNonResiduePower3 set z=x*(1,1)^(3*(p-1)/6) and return z
func (z *E2) MulByNonResiduePower3(x *E2) *E2 {
	// (1,1)^(3*(p-1)/6)
	// 1028732146235106349975324479215795277384839936929757896155643118032610843298655225875571310552543014690878354869257 + u*1028732146235106349975324479215795277384839936929757896155643118032610843298655225875571310552543014690878354869257
	b := E2{
		A0: fp.Element{
			8921533702591418330,
			15859389534032789116,
			3389114680249073393,
			15116930867080254631,
			3288288975085550621,
			1021049300055853010,
		},
		A1: fp.Element{
			8921533702591418330,
			15859389534032789116,
			3389114680249073393,
			15116930867080254631,
			3288288975085550621,
			1021049300055853010,
		},
	}
	z.Mul(x, &b)
	return z
}

// MulByNonResiduePower4 set z=x*(1,1)^(4*(p-1)/6) and return z
func (z *E2) MulByNonResiduePower4(x *E2) *E2 {
	// (1,1)^(4*(p-1)/6)
	// 4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939437
	b := fp.Element{
		9875771541238924739,
		3094855109658912213,
		5802897354862067244,
		11677019699073781796,
		1505592401347711080,
		1505729768134575418,
	}
	z.A0.Mul(&x.A0, &b)
	z.A1.Mul(&x.A1, &b)
	return z
}

// MulByNonResiduePower5 set z=x*(1,1)^(5*(p-1)/6) and return z
func (z *E2) MulByNonResiduePower5(x *E2) *E2 {
	// (1,1)^(5*(p-1)/6)
	// 877076961050607968509681729531255177986764537961432449499635504522207616027455086505066378536590128544573588734230 + u*3125332594171059424908108096204648978570118281977575435832422631601824034463382777937621250592425535493320683825557
	b := E2{
		A0: fp.Element{
			9428352843095270463,
			11709709036094816655,
			14335180424952013185,
			8441381030041026197,
			5369959062663957099,
			1665664447512374973,
		},
		A1: fp.Element{
			3974078172982593132,
			8947176549131943536,
			11547238222321620130,
			17244701004083237929,
			42144715806745195,
			208134170135164893,
		},
	}
	z.Mul(x, &b)
	return z
}

// MulByNonResiduePowerSquare1 set z=x*(1,1)^(1*(p^2-1)/6) and return z
func (z *E2) MulByNonResiduePowerSquare1(x *E2) *E2 {
	// (1,1)^(1*(p^2-1)/6)
	// 793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620351
	b := fp.Element{
		17076301903736715834,
		13907359434105313836,
		1063007777899403918,
		15402659025741563681,
		5125705813544623108,
		76826746747117401,
	}
	z.A0.Mul(&x.A0, &b)
	z.A1.Mul(&x.A1, &b)
	return z
}

// MulByNonResiduePowerSquare2 set z=x*(1,1)^(2*(p^2-1)/6) and return z
func (z *E2) MulByNonResiduePowerSquare2(x *E2) *E2 {
	// (1,1)^(2*(p^2-1)/6)
	// 793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350
	b := fp.Element{
		3526659474838938856,
		17562030475567847978,
		1632777218702014455,
		14009062335050482331,
		3906511377122991214,
		368068849512964448,
	}
	z.A0.Mul(&x.A0, &b)
	z.A1.Mul(&x.A1, &b)
	return z
}

// MulByNonResiduePowerSquare3 set z=x*(1,1)^(3*(p^2-1)/6) and return z
func (z *E2) MulByNonResiduePowerSquare3(x *E2) *E2 {
	// (1,1)^(3*(p^2-1)/6)
	// 4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272559786
	b := fp.Element{
		4897101644811774638,
		3654671041462534141,
		569769440802610537,
		17053147383018470266,
		17227549637287919721,
		291242102765847046,
	}
	z.A0.Mul(&x.A0, &b)
	z.A1.Mul(&x.A1, &b)
	return z
}

// MulByNonResiduePowerSquare4 set z=x*(1,1)^(4*(p^2-1)/6) and return z
func (z *E2) MulByNonResiduePowerSquare4(x *E2) *E2 {
	// (1,1)^(4*(p^2-1)/6)
	// 4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436
	b := fp.Element{
		14772873186050699377,
		6749526151121446354,
		6372666795664677781,
		10283423008382700446,
		286397964926079186,
		1796971870900422465,
	}
	z.A0.Mul(&x.A0, &b)
	z.A1.Mul(&x.A1, &b)
	return z
}

// MulByNonResiduePowerSquare5 set z=x*(1,1)^(5*(p^2-1)/6) and return z
func (z *E2) MulByNonResiduePowerSquare5(x *E2) *E2 {
	// (1,1)^(5*(p^2-1)/6)
	// 4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939437
	b := fp.Element{
		9875771541238924739,
		3094855109658912213,
		5802897354862067244,
		11677019699073781796,
		1505592401347711080,
		1505729768134575418,
	}
	z.A0.Mul(&x.A0, &b)
	z.A1.Mul(&x.A1, &b)
	return z
}

// MulByNonResiduePowerCube1 set z=x*(1,1)^(1*(p^3-1)/6) and return z
func (z *E2) MulByNonResiduePowerCube1(x *E2) *E2 {
	// (1,1)^(1*(p^3-1)/6)
	// 2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530 + u*1028732146235106349975324479215795277384839936929757896155643118032610843298655225875571310552543014690878354869257
	b := E2{
		A0: fp.Element{
			4480897313486445265,
			4797496051193971075,
			4046559893315008306,
			10569151167044009496,
			2123814803385151673,
			852749317591686856,
		},
		A1: fp.Element{
			8921533702591418330,
			15859389534032789116,
			3389114680249073393,
			15116930867080254631,
			3288288975085550621,
			1021049300055853010,
		},
	}
	z.Mul(x, &b)
	return z
}

// MulByNonResiduePowerCube2 set z=x*(1,1)^(2*(p^3-1)/6) and return z
func (z *E2) MulByNonResiduePowerCube2(x *E2) *E2 {
	// (1,1)^(2*(p^3-1)/6)
	// 0 + u*1
	b := E2{
		A0: fp.Element{
			0,
			0,
			0,
			0,
			0,
			0,
		},
		A1: fp.Element{
			8505329371266088957,
			17002214543764226050,
			6865905132761471162,
			8632934651105793861,
			6631298214892334189,
			1582556514881692819,
		},
	}
	z.Mul(x, &b)
	return z
}

// MulByNonResiduePowerCube3 set z=x*(1,1)^(3*(p^3-1)/6) and return z
func (z *E2) MulByNonResiduePowerCube3(x *E2) *E2 {
	// (1,1)^(3*(p^3-1)/6)
	// 2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530 + u*2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530
	b := E2{
		A0: fp.Element{
			4480897313486445265,
			4797496051193971075,
			4046559893315008306,
			10569151167044009496,
			2123814803385151673,
			852749317591686856,
		},
		A1: fp.Element{
			4480897313486445265,
			4797496051193971075,
			4046559893315008306,
			10569151167044009496,
			2123814803385151673,
			852749317591686856,
		},
	}
	z.Mul(x, &b)
	return z
}

// MulByNonResiduePowerCube4 set z=x*(1,1)^(4*(p^3-1)/6) and return z
func (z *E2) MulByNonResiduePowerCube4(x *E2) *E2 {
	// (1,1)^(4*(p^3-1)/6)
	// 4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272559786
	b := fp.Element{
		4897101644811774638,
		3654671041462534141,
		569769440802610537,
		17053147383018470266,
		17227549637287919721,
		291242102765847046,
	}
	z.A0.Mul(&x.A0, &b)
	z.A1.Mul(&x.A1, &b)
	return z
}

// MulByNonResiduePowerCube5 set z=x*(1,1)^(5*(p^3-1)/6) and return z
func (z *E2) MulByNonResiduePowerCube5(x *E2) *E2 {
	// (1,1)^(5*(p^3-1)/6)
	// 1028732146235106349975324479215795277384839936929757896155643118032610843298655225875571310552543014690878354869257 + u*2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530
	b := E2{
		A0: fp.Element{
			8921533702591418330,
			15859389534032789116,
			3389114680249073393,
			15116930867080254631,
			3288288975085550621,
			1021049300055853010,
		},
		A1: fp.Element{
			4480897313486445265,
			4797496051193971075,
			4046559893315008306,
			10569151167044009496,
			2123814803385151673,
			852749317591686856,
		},
	}
	z.Mul(x, &b)
	return z
}
